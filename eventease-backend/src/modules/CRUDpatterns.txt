CRUD patterns

Create

export async function createThing(data) {
  const inserted = await db.insert(tableName).values(data).returning();
  return inserted[0];
}


Read all

export async function getAllThings() {
  const result = await db.select().from(tableName);
  return result;
}


Read by id

export async function getThingById(id) {
  const result = await db
    .select()
    .from(tableName)
    .where(eq(tableName.id, id));

  return result[0] || null;
}


Update

export async function updateThing(id, data) {
  const updated = await db
    .update(tableName)
    .set(data)
    .where(eq(tableName.id, id))
    .returning();

  return updated[0] || null;
}


Delete

export async function deleteThing(id) {
  const deleted = await db
    .delete(tableName)
    .where(eq(tableName.id, id))
    .returning();

  return deleted[0] || null;
}

* .returning() -->
Use .returning() ONLY when you need the data back after we use - 
✔ After INSERT- You want the newly created row, including autogenerated fields like id
✔ After UPDATE- You want the updated row to send back to the client.
✔ After DELETE- You want to know what was deleted.
Don’t use it for SELECT

* parameters -->
You use parameters when the service needs some piece of specific data to run the query.
You need params - For fetching, updating, deleting, creating
You dont need params - When the function retrieves all data without filtering.